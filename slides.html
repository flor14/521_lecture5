<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>DSCI 521 - Lecture 5</title>
    <meta charset="utf-8" />
    <meta name="author" content="MDS 2021/22" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/js-cookie/js.cookie.js"></script>
    <script src="libs/peerjs/peerjs.min.js"></script>
    <script src="libs/tiny.toast/toast.min.js"></script>
    <link href="libs/xaringanExtra-broadcast/broadcast.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-broadcast/broadcast.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/shareon/shareon.min.css" rel="stylesheet" />
    <script src="libs/shareon/shareon.min.js"></script>
    <link href="libs/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-shareagain/shareagain.js"></script>
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <script src="libs/xaringanExtra_fit-screen/fit-screen.js"></script>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">











class: middle, center

&lt;img src="img/hex.png" width="150" style="display: block; margin: auto;" /&gt;


---


class: bottom

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt5[
### DSCI 521 - Lecture 5
### **RStudio and R Markdown**

 .large[#### Computing Platforms for Data Science - UBC MDS 2021/22
]]


---

## Lecture 5


1. Know our way around the **RStudio** interface

--

2. Edit and run **R scripts** within RStudio

--

3. Create an **RStudio project**

--

4. Compose **RMarkdown** documents

---

class: center, middle, inverse

# RSTUDIO

---

## RStudio interface 

&lt;img src="img/rstudio_open.png" width="800" style="display: block; margin: auto;" /&gt;



---

### Interactive Development Environment (IDE)

We are already familiar with JupyterLab



&lt;img src="img/jlab_rstudio.png" width="900" style="display: block; margin: auto;" /&gt;


---

### Plots

If a plot is generate from the executed code, it will show up in the **Plots** tab in the bottom left panel. 



```r
plot(cars)
```

&lt;img src="slides_files/figure-html/obj4-1.png" width="200" style="display: block; margin: auto;" /&gt;



.footnote[Note: it uses a built-in data set called `cars`]












---

### R Scripts

To create a new R Script, navigate to `New File -&gt; R Script`. 


```R
x &lt;- 5
y &lt;- x + 3
print(paste0("y = ", y))
```
---

### Run the script


.pull-top[

&lt;img src="img/run.png" width="500" style="display: block; margin: auto;" /&gt;


]

.pull-bottom[

- **Run** button to run just part of a script, which runs any highlighted lines.**Keyboard shortcut: ** `Ctrl + Enter`

- **Source** button to run the entire script 
 




]







---

## RStudio interface 

The editor is open now!

&lt;img src="img/rstudio_ide.png" width="800" style="display: block; margin: auto;" /&gt;


---

## RStudio interface
#### Tabs

.pull-left[

&lt;img src="img/rstudio_ide.png" width="500" style="display: block; margin: auto;" /&gt;


]

.pull-right[



- **Editor**  is where you write R code that will be saved as a file.  
- **Console**  is where R commands are sent and evaluated by R. No R code written here is saved.  
- **Environment**  shows the currently defined variables.  
- **Files**  let's you navigate your file system. This panel also has the "Plots" and "Help" tabs which show figures you create and function documentation, respectively.



]
---

## RStudio interface 

&lt;img src="img/rscheatsheet.png" width="550" style="display: block; margin: auto;" /&gt;


.footnote[[RStudio Cheat sheets](https://www.rstudio.com/resources/cheatsheets/)]

---


## Editing RStudio settings to not save workspace data


In general, we **NEVER** want to save our workspace (or load a previous one). 
We can avoid accidentally doing this through turning it off in the RStudio global options in the Tools menu.


&lt;img src="img/rdata.png" width="300" style="display: block; margin: auto;" /&gt;

---

## Where we are? üó∫Ô∏è

#### Different from JupyterLab
When you open RStudio the current working directory is not necessarily the project working directory.

--

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt5[

#### EVERY SESSION you need to tell RStudio where you are working
]

---

## Where we are? üó∫



You can find out one of two ways:

1. type `getwd()` in the console

2. In the files pane, 
  - click the cog/More button and then click **"Go To Working Directory"**


---

## Setting the working directory


1. Use an **RStudio project** 

--

2. In the _Files pane_
  - Navigate the file structure to where you want the working directory to be.
  - Then click the cog/More button and then click **Set As Working Directory**
  
--

3. In the _Session menu_, 
  - Click **Set Working Directory** 
  - Then **Choose Directory**

--

4. Type `setwd("PATH")` in the _Console_ 

--

.footnote[[üî• Project oriented workflow üî• - Jenny Bryan](https://www.tidyverse.org/blog/2017/12/workflow-vs-script/)]

---


class: middle, center, inverse
 
# RStudio projects

---


class: middle

### An RStudio project is essentially a directory containing a special file: `*.Rproj`, which holds metadata for R about this project.


---

## Creating RStudio Projects


You can either create an empty RStudio project, or clone an existing GitHub repo, which also allows you to use the RStudio interface to control Git.

&lt;img src="img/pj.png" width="300" style="display: block; margin: auto;" /&gt;
---

## RProjects set the working directory by default

We recommend using it together with the `here()` package, which can easily create paths relative to root project dir:


```r
install.packages("here")
library(here)

# If you data is in project_root/files/data/
# this will make sure that anyone using your project
# will get the correct path
 here("files", "data", "iris.csv")
```





---

class: middle, center, inverse

# R Markdown and   
# R Notebooks


---

## Notebooks

- You can interleave writing code, formatted narrative text, and view output all in the same document. 

- Notebooks are examples of what it is called **literate programming** where the goal is to mix code and paragraph text seamlessly.

#### Notebooks
Jupyter Notebooks ‚úîÔ∏è  
  
 &lt;span style="background-color:#00FF00"&gt;R Markdown Notebooks&lt;/span&gt;

---

### R Markdown documents 

**R Markdown documents (.Rmd)** are most commonly run via R Notebooks which work similarly to Jupyter notebooks 
  
##### Let's see an example of this by creating a new R Notebook via `File -&gt; New -&gt; R Notebook`. 




&lt;img src="img/rmarkdown.png" width="100" style="display: block; margin: auto auto auto 0;" /&gt;


.footnote[[What is the difference between a Notebook and an R Markdown file?](https://argoshare.is.ed.ac.uk/healthyr_book/what-is-the-difference-between-a-notebook-and-an-r-markdown-file.html)]

---

## R Markdown

We are going to learn with more detail the parts of an R Markdown file in lab3

&lt;img src="img/rnotebook.png" width="800" style="display: block; margin: auto;" /&gt;


.footnote[[R Markdown](https://rmarkdown.rstudio.com/)]

---

### Text and rendering R Markdown documents


.pull-left[

**R Markdown only**
- Any line of text not in a code chunk will be formatted using Markdown. 
- To see this text rendered, you need to render the whole document

]

.pull-right[

**R Markdown and JupyterLab**

- You can use HTML and LaTeX here to do more advanced formatting. 

]


--

#### "Knit" or "Preview" button?
  - **Preview** creates a HTML version of your document as it looks right now
  - **Knit** first restarts the R session and runs through the entire document from the beginning to make sure it will work when you send it to someone else.


---

### A helpful hint 
#### for successfully working with R Markdown documents


##### - it is important to "knit" often as you make changes.


.footnote[This is similar to run "Run all cells" in Jupyter Notebooks]

---

## Jupyter Notebooks are stored in JSON format


.pull-left[

&lt;img src="img/editjson.png" width="600" style="display: block; margin: auto;" /&gt;
]

.pull-right[

- Difficult to edit as plain text
- Merge conflicts are more complicated to solve  

When you save a file in `.ipynb` format you are saving a .JSON too.

]
 
---

## JupyText

It is a plugin that can save **Jupyter notebooks** as either Markdown files or Scripts in many languages!

- Install JupyText
- Open the Command Palette and look for Paired Notebooks




.footnote[[JupyText](https://github.com/mwouts/jupytext)]

---

### Running, editing and creating code chunks

#### Code cells


.pull-left[

**R Markdown**
- Referred to as code "chunks" or "blocks" 
- To see this text rendered, you need to render the whole document

]

.pull-right[

**R Markdown and Jupyter Lab**

- You can use HTML and LaTeX here to do more advanced formatting. 

]

---

### Running, editing and creating code chunks


- R Markdown has code cells, although they're more commonly referred to as **code "chunks"** or "blocks". 

--

- Unique to R Markdown is that the leading three backticks are followed by curly braces containing the language engine you want to run.

--



```r
x &lt;- 5
```


---

### Running, editing and creating code chunks

- All code cells are run when you knit/render the entire document (like pressing "Run all" in JupyterLab). 

--

- By default, the code in the chunk and the code output will be included in your rendered document.

--

- You can also run the code by clicking the green play button on the right-hand side of the code chunk.

---

## Naming code chunks and R Markdown document sections

- When you include Markdown headers (using the # symbol) R Studio automatically creates a pop-up-like menu for you to use to navigate the document, which you can access by clicking the bar below this editor panel. It looks like:

&lt;img src="img/namesections.png" width="600" style="display: block; margin: auto;" /&gt;

---

## Naming code chunks and R Markdown document sections



- **Do not duplicate code chunk names**, this will break the rendering of your document!



```r
# initialize sum to 0
loop_sum &lt;- 0

# loop of a sequence from 1 to 10 and calculate the sum
for (i in seq(1:10)){
  loop_sum &lt;- loop_sum + i
}

print(loop_sum)
```
---

## Code snippets
As we started to type for above, the code completion popped up and the first entry said "snippet", what is that? A code snippet is a text macro, which means that you can type a short string of characters to insert a template or snippet of text by pressing TAB. You can see all the default snippets and define your own by going to `Tools -&gt; Global options -&gt; Code -&gt; Edit snippets`.
Snippets are available anywhere in RStudio, not just in R Markdown documents.



&lt;img src="img/snippets.png" width="300" style="display: block; margin: auto auto auto 0;" /&gt;
---

## Code snippets
&lt;img src="img/snippets2.png" width="600" style="display: block; margin: auto auto auto 0;" /&gt;


---

## Code chunk options
There are many code chunk options that you can set. These options let you customize chunk behavior, including whether a chunk is evaluated, whether to include the output in the rendered document, etc. A short list of code chunk options is shown below, but you can find an extensive list starting on the second page of this document.

You can set the chunk options at either a global level (once set they will be applied to all code chunks in the .Rmd file) or locally for a specific chunk (these will override the global chunk options if they are contradictory).

Global options are usually set in one chunk at the top of the document and looks like this (this is a screenshot):

&lt;img src="img/chunk_options.png" width="500" style="display: block; margin: auto auto auto 0;" /&gt;

.footnote[[Chunk options and package options](https://yihui.org/knitr/options/)]

---


## Code chunk options


- **Global chunk options** are set by adding them as arguments to `knitr::opts_chunk$set(...)` (put them in place of ... and separate multiple options with a comma). The only global chunk options set in this document is `echo = FALSE`, which hides the code chunks and only shows the output, something that can be useful for non-technical reports.

--

- **Local chunk options** are set by adding the options in the curly braces of a code chunk after the language engine and code chunk name. For example, to not display warnings in a single code chunk we would use the `warning = FALSE` code chunk as follows:

--



---

## A few tips and tricks

##### R Markdown support **inline evaluated code** via the following syntax
  - Adding 3 to 4 gives 7.
  - The value of `x` is currently 5.  
  
--

##### Latex equations can be written the same way as in Jupyter notebooks and standard markdown documents.
- `$\alpha = 5$` for inline latex and `$$\alpha = 5$$` for a math block.
- When hovering over equations, R will display the rendered equation in a pop up.

---

## A few tips and tricks

##### R Markdown is built upon the **Pandoc** Markdown engine. 

- This is useful to know since the Pandoc manual is a great exhaustive resource for looking up anything Markdown related.

- One of the features made available thanks to Pandoc is support for **citations and bibliographies**.
  - Let's cite the R-package by typing `citation()` into the console, and copying the BibTex citation into a new document that we call `rstudio-demo.bib` 
and adding an identifier string (a key) before the first comma,
e.g.r-lang`.


.footnote[[Pandoc](https://pandoc.org/)]
---

## A few tips and tricks

Include the following field in the YAML metadata in the beginning of the document: bibliography: rstudio-demo.bib, then cite it somewhere in the text by adding [@r-lang]. The bibliography will be appended to the document, so it is advisable to add a heading saying # References at the very end.
When working with R Markdown (and code in general) be careful that you don't copy stylized quotation marks because these will not work. For example, this will throw an error:

a = **‚Äú**This string**‚Äù**
It should look like this instead:

a = **"**This string**"**



---

## References

.bg-washed-blue.b--dark-blue.ba.bw2.br3.shadow-5.ph4.mt5[

 [Elegant, flexible, and fast dynamic report generation with R](https://yihui.org/knitr/)

 [JupyText](https://github.com/mwouts/jupytext)

 [Pandoc](https://pandoc.org/)
 
 [R Markdown documents](https://rmarkdown.rstudio.com/)

 [R Markdown: The Definitive Guide](https://bookdown.org/yihui/rmarkdown/)


]

---

class: inverse, middle, center


## Thank you!





    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="https://platform.twitter.com/widgets.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
